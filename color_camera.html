<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Kameratracking RollB</title>

    <script src="tracking-min.js"></script>
    <script src="stats.min.js"></script>

    <style>
        video, canvas {
            margin-left: 100px;
            margin-top: 35px;
            position: absolute;
        }
    </style>
</head>
<body>


<div class="demo-frame">
    <div class="demo-container">
        <video id="video" width="1000" height="850" preload autoplay loop muted controls></video>
        <canvas id="canvas" width="1000" height="850"></canvas>
    </div>
</div>

<script>
    window.onload = function () {
        var video = document.getElementById('video');
        var canvas = document.getElementById('canvas');
        var context = canvas.getContext('2d');
        var middle = canvas.getContext('2d');

        tracking.ColorTracker.registerColor('green', function (r, g, b) {
            if (r < 50 && g > 200 && b < 50) {
                return true;
            }
            return false;
        });

        tracking.ColorTracker.registerColor('blue', function (r, g, b) {
            if (r < 50 && g < 50 && b > 200) {
                return true;
            }
            return false;
        });

        var tracker = new tracking.ColorTracker(["yellow", "green", "blue"]);
        // var tracker = new tracking.ColorTracker(["blue"]);


        tracking.track('#video', tracker, {camera: true});

        tracker.on('track', function (event) {
            context.clearRect(0, 0, canvas.width, canvas.height);

            event.data.forEach(function (rect) {
                if (rect.color === 'custom') {
                    rect.color = tracker.customColor;
                }

                var koordinateX = rect.x + rect.width / 2;
                var koordinateY = rect.y + rect.height / 2;

                context.strokeStyle = rect.color;
                context.strokeRect(rect.x, rect.y, rect.width, rect.height);
                context.font = '11px Helvetica';
                context.fillStyle = "#fff";
                context.fillText('x: ' + rect.x + 'px', rect.x + rect.width + 5, rect.y + 11);
                context.fillText('y: ' + rect.y + 'px', rect.x + rect.width + 5, rect.y + 22);

                middle.fillRect(koordinateX, koordinateY, 10, 10);

                sendGetRequest("http://141.75.33.246:8888/" + "X=" + koordinateX + ".....Y=" + koordinateY);

            });
        });
    };

    function sendGetRequest(url) {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function () {
        };
        xmlhttp.open("GET", url, true);
        xmlhttp.send();
    }


</script>

</body>
</html>
